
-- 개인 테스트용

-- 게시판 종류
DROP TABLE "COMMUNITY";

CREATE TABLE "BOARD_TYPE" (
	"BOARD_CD"	NUMBER		PRIMARY KEY,
	"BOARD_NM"	VARCHAR2(50)		NOT NULL
);

COMMENT ON COLUMN "BOARD_TYPE"."BOARD_CD" IS '게시판 코드';
COMMENT ON COLUMN "BOARD_TYPE"."BOARD_NM" IS '게시판 이름';

INSERT INTO BOARD_TYPE VALUES(1,'자유게시판');
INSERT INTO BOARD_TYPE VALUES(2,'후기게시판');

-- 자유/후기 게시글 
DROP TABLE "BOARD";

CREATE TABLE "BOARD" (
	"BOARD_NO"	NUMBER PRIMARY KEY,
	"BOARD_TITLE"	VARCHAR2(150)		NOT NULL,
	"BOARD_CONTENT"	VARCHAR2(4000)		NOT NULL,
	"CREATE_DT"	DATE	DEFAULT SYSDATE	NOT NULL,
	"READ_COUNT"	NUMBER	DEFAULT 0	NOT NULL,
	"BOARD_ST"	CHAR(1)	DEFAULT 'N'	NOT NULL,
	"BOARD_CD"	NUMBER REFERENCES BOARD_TYPE,
	"MEMBER_NO"	NUMBER REFERENCES MEMBER
	"COMMUNITY_NO"	NUMBER		NOT NULL
);

COMMENT ON COLUMN "BOARD"."BOARD_NO" IS '게시글 번호';
COMMENT ON COLUMN "BOARD"."BOARD_TITLE" IS '게시글 제목';
COMMENT ON COLUMN "BOARD"."BOARD_CONTENT" IS '게시글 내용';
COMMENT ON COLUMN "BOARD"."CREATE_DT" IS '작성일';
COMMENT ON COLUMN "BOARD"."READ_COUNT" IS '조회수';
COMMENT ON COLUMN "BOARD"."BOARD_ST" IS '게시글 상태(정상N, 삭제Y)';
COMMENT ON COLUMN "BOARD"."BOARD_CD" IS '게시판 코드';
COMMENT ON COLUMN "BOARD"."MEMBER_NO" IS '게시글 작성자';
COMMENT ON COLUMN "BOARD"."COMMUNITY_NO" IS '모임 번호';

CREATE SEQUENCE SEQ_BOARD_NO;

-- 샘플
INSERT INTO BOARD
VALUES(2, '모임1 자유게시판 제목', '샘플 데이터 내용', DEFAULT, DEFAULT, DEFAULT, 1, 1, 1);
INSERT INTO BOARD
VALUES(SEQ_BOARD_NO.NEXTVAL, '자유게시판 제목2', '샘플 데이터 내용2', DEFAULT, DEFAULT, DEFAULT, 1, 0, 1);

INSERT INTO BOARD
VALUES(SEQ_BOARD_NO.NEXTVAL, '후기게시판 제목1', '샘플 데이터 내용1', DEFAULT, DEFAULT, DEFAULT, 2, 0, 1);
INSERT INTO BOARD
VALUES(SEQ_BOARD_NO.NEXTVAL, '후기게시판 제목2', '샘플 데이터 내용2', DEFAULT, DEFAULT, DEFAULT, 2, 0, 1);
INSERT INTO BOARD
VALUES(SEQ_BOARD_NO.NEXTVAL, '후기게시판 제목3', '샘플 데이터 내용3', DEFAULT, DEFAULT, DEFAULT, 2, 0, 1);
INSERT INTO BOARD
VALUES(SEQ_BOARD_NO.NEXTVAL, '후기게시판 제목4', '샘플 데이터 내용4', DEFAULT, DEFAULT, DEFAULT, 2, 0, 1);
INSERT INTO BOARD
VALUES(SEQ_BOARD_NO.NEXTVAL, '후기게시판 제목5', '샘플 데이터 내용5', DEFAULT, DEFAULT, DEFAULT, 2, 0, 1);
INSERT INTO BOARD
VALUES(SEQ_BOARD_NO.NEXTVAL, '후기게시판 제목6', '샘플 데이터 내용6', DEFAULT, DEFAULT, DEFAULT, 2, 0, 1);
INSERT INTO BOARD
VALUES(SEQ_BOARD_NO.NEXTVAL, '후기게시판 제목7', '샘플 데이터 내용7', DEFAULT, DEFAULT, DEFAULT, 2, 0, 1);
INSERT INTO BOARD
VALUES(SEQ_BOARD_NO.NEXTVAL, '후기게시판 제목8', '샘플 데이터 내용8', DEFAULT, DEFAULT, DEFAULT, 2, 0, 1);
INSERT INTO BOARD
VALUES(SEQ_BOARD_NO.NEXTVAL, '후기게시판 제목9', '샘플 데이터 내용9', DEFAULT, DEFAULT, DEFAULT, 2, 0, 1);
INSERT INTO BOARD
VALUES(SEQ_BOARD_NO.NEXTVAL, '후기게시판 제목10', '샘플 데이터 내용10', DEFAULT, DEFAULT, DEFAULT, 2, 0, 1);

SELECT * FROM BOARD;

-- 게시판 상세조회
SELECT BOARD_NO, BOARD_TITLE, BOARD_CONTENT, 
		TO_CHAR(CREATE_DT, 'YYYY-MM-DD') CREATE_DT,
		READ_COUNT, MEMBER_NICK, PROFILE_IMG, MEMBER_NO, BOARD_NM
FROM BOARD 
JOIN MEMBER USING(MEMBER_NO)
JOIN BOARD_TYPE USING(BOARD_CD)
WHERE BOARD_NO = 15
AND BOARD_ST = 'N'
AND COMMUNITY_NO = 1;

UPDATE BOARD SET
		BOARD_ST = 'Y'
		WHERE BOARD_NO = 41
		AND COMMUNITY_NO = 1
		AND BOARD_CD = 1;

update member set PROFILE_IMG = '/resources/images/admin.png'
where member_no = 1;

-- 게시판 조회 
SELECT * FROM(
	SELECT ROWNUM RNUM, A.* FROM(
		SELECT BOARD_NO, BOARD_NM, BOARD_TITLE, MEMBER_NICK,
			TO_CHAR(CREATE_DT, 'YYYY-MM-DD') AS CREATE_DT, READ_COUNT
		FROM BOARD
		JOIN BOARD_TYPE USING(BOARD_CD)
		JOIN MEMBER USING(MEMBER_NO)
		WHERE BOARD_CD = 1
		AND BOARD_ST = 'N'
		ORDER BY BOARD_NO DESC
	) A
)
WHERE RNUM BETWEEN 1 AND 10;

-- 후기 게시판 조회
SELECT * FROM(
	SELECT ROWNUM RNUM, A.* FROM(
		SELECT BOARD_NO, BOARD_NM, BOARD_TITLE, MEMBER_NICK,
			TO_CHAR(CREATE_DT, 'YYYY-MM-DD') AS CREATE_DT, READ_COUNT
		FROM BOARD
		JOIN BOARD_TYPE USING(BOARD_CD)
		JOIN MEMBER USING(MEMBER_NO)
		WHERE BOARD_CD = 1
		AND BOARD_ST = 'N'
		ORDER BY BOARD_NO DESC
	) A
)
WHERE RNUM BETWEEN 1 AND 10

INSERT INTO BOARD_IMG VALUES(SEQ_IMG_NO.NEXTVAL, 0, 1, '/resources/images/notice/sample1.png', 'pick1.png');


-- 관리자 게시판
DROP TABLE "NOTICE_TYPE";

CREATE TABLE "NOTICE_TYPE" (
	"NOTICE_CD"	NUMBER		PRIMARY KEY,
	"NOTICE_NM"	VARCHAR2(50)		NOT NULL
);

COMMENT ON COLUMN "NOTICE_TYPE"."NOTICE_CD" IS '공지사항 코드';
COMMENT ON COLUMN "NOTICE_TYPE"."NOTICE_NM" IS '공지사항 이름';

INSERT INTO NOTICE_TYPE VALUES(1,'공지사항');
INSERT INTO NOTICE_TYPE VALUES(2,'이벤트');
INSERT INTO NOTICE_TYPE VALUES(3,'당첨자 발표');

SELECT * FROM NOTICE_TYPE;

-- 공지사항
DROP TABLE "NOTICE";

CREATE TABLE "NOTICE" (
	"NOTICE_NO"	NUMBER		NOT NULL,
	"NOTICE_CD"	NUMBER		NOT NULL,
	"NOTICE_TITLE"	VARCHAR2(150)		NOT NULL,
	"NOTICE_CONTENT"	VARCHAR2(4000)		NOT NULL,
	"CREATE_DT"	DATE	DEFAULT SYSDATE	NOT NULL,
	"READ_COUNT"	NUMBER	DEFAULT 0	NOT NULL,
	"NOTICE_ST"	CHAR(1)	DEFAULT 'N'	NOT NULL,
	"MEMBER_NO"	NUMBER		NOT NULL
);


COMMENT ON COLUMN "NOTICE"."NOTICE_NO" IS '공지사항 번호';
COMMENT ON COLUMN "NOTICE"."NOTICE_CD" IS '카테고리 코드';
COMMENT ON COLUMN "NOTICE"."NOTICE_TITLE" IS '공지사항 제목';
COMMENT ON COLUMN "NOTICE"."NOTICE_CONTENT" IS '공지사항 내용';
COMMENT ON COLUMN "NOTICE"."CREATE_DT" IS '작성일';
COMMENT ON COLUMN "NOTICE"."READ_COUNT" IS '조회수';
COMMENT ON COLUMN "NOTICE"."NOTICE_ST" IS '공지사항 상태(정상N, 삭제Y)';
COMMENT ON COLUMN "NOTICE"."MEMBER_NO" IS '작성자 회원 번호';

CREATE SEQUENCE SEQ_NOTICE_NO;

ALTER TABLE NOTICE ADD PRIMARY KEY(NOTICE_NO);

ALTER TABLE NOTICE 
ADD CONSTRAINT "FK_NOTICE_CD" 
FOREIGN KEY("NOTICE_CD")
REFERENCES "NOTICE_TYPE";

ALTER TABLE NOTICE
ADD CONSTRAINT "CHK_NOTICE_ST"
CHECK ("NOTICE_ST" IN ('N','Y'));

-- 샘플
INSERT INTO NOTICE
VALUES(SEQ_NOTICE_NO.NEXTVAL, 2, '3번째 이벤트', '3번째 이벤트 내용', DEFAULT, DEFAULT, 'Y', 0);
INSERT INTO NOTICE
VALUES(SEQ_NOTICE_NO.NEXTVAL, 1, '3번째 공지', '3번째 공지 내용', DEFAULT, DEFAULT, DEFAULT, 0);
INSERT INTO NOTICE
VALUES(SEQ_NOTICE_NO.NEXTVAL, 1, '4번째 공지', '4번째 공지 내용', DEFAULT, DEFAULT, DEFAULT, 0);
INSERT INTO NOTICE
VALUES(SEQ_NOTICE_NO.NEXTVAL, 1, '5번째 공지', '5번째 공지 내용', DEFAULT, DEFAULT, DEFAULT, 0);
INSERT INTO NOTICE
VALUES(SEQ_NOTICE_NO.NEXTVAL, 1, '6번째 공지', '6번째 공지 내용', DEFAULT, DEFAULT, DEFAULT, 0);
INSERT INTO NOTICE
VALUES(SEQ_NOTICE_NO.NEXTVAL, 1, '7번째 공지', '7번째 공지 내용', DEFAULT, DEFAULT, DEFAULT, 0);
INSERT INTO NOTICE
VALUES(SEQ_NOTICE_NO.NEXTVAL, 1, '8번째 공지', '8번째 공지 내용', DEFAULT, DEFAULT, DEFAULT, 0);
INSERT INTO NOTICE
VALUES(SEQ_NOTICE_NO.NEXTVAL, 1, '9번째 공지', '9번째 공지 내용', DEFAULT, DEFAULT, DEFAULT, 0);
INSERT INTO NOTICE
VALUES(SEQ_NOTICE_NO.NEXTVAL, 1, '10번째 공지', '10번째 공지 내용', DEFAULT, DEFAULT, DEFAULT, 0);
INSERT INTO NOTICE
VALUES(SEQ_NOTICE_NO.NEXTVAL, 1, '11번째 공지', '11번째 공지 내용', DEFAULT, DEFAULT, DEFAULT, 0);

INSERT INTO NOTICE
VALUES(SEQ_NOTICE_NO.NEXTVAL, 2, '첫번째 이벤트', '첫번째 이벤트 내용', DEFAULT, DEFAULT, DEFAULT, 0);
INSERT INTO NOTICE
VALUES(SEQ_NOTICE_NO.NEXTVAL, 3, '첫번째 당첨자 발표', '첫번째 당첨자 발표 내용', DEFAULT, DEFAULT, DEFAULT, 0);


SELECT * FROM NOTICE;

UPDATE NOTICE SET NOTICE_ST = 'N' WHERE NOTICE_NO = 73;
UPDATE NOTICE SET NOTICE_ST = 'N' WHERE NOTICE_NO = 72;
UPDATE NOTICE SET NOTICE_ST = 'N' WHERE NOTICE_NO = 71;
UPDATE NOTICE SET NOTICE_ST = 'N' WHERE NOTICE_NO = 70;

SELECT NOTICE_NM FROM NOTICE_TYPE WHERE NOTICE_CD = 2;

SELECT COUNT(*) FROM NOTICE 
WHERE NOTICE_ST = 'N'
AND NOTICE_CD = 1;

SELECT * FROM(
	SELECT ROWNUM RNUM, A.* FROM(
		SELECT NOTICE_NO, NOTICE_NM, NOTICE_TITLE, MEMBER_NO, 
			TO_CHAR(CREATE_DT, 'YYYY.MM.DD') AS CREATE_DT, 
			READ_COUNT
		FROM NOTICE
		JOIN NOTICE_TYPE USING (NOTICE_CD)
		WHERE NOTICE_ST = 'N'
		ORDER BY NOTICE_NO DESC
	) A
)
WHERE RNUM BETWEEN 1 AND 20;

-- 공지 게시글 조회
-- SELECT NOTICE_NO, NOTICE_TITLE, NOTICE_CONTENT, 
-- 		   TO_CHAR(CREATE_DT, 'YYYY.MM.DD') CREATE_DT,
-- 		   READ_COUNT, PROFILE_IMG, MEMBER_NICK, MEMBER_NO, NOTICE_NM
-- 		FROM NOTICE 
-- 		JOIN NOTICE_TYPE USING(NOTICE_CD)
-- 		WHERE NOTICE_NO = 23
-- 		AND NOTICE_ST = 'N';
SELECT NOTICE_NO, NOTICE_TITLE, NOTICE_CONTENT, 
		   TO_CHAR(CREATE_DT, 'YYYY.MM.DD') CREATE_DT, READ_COUNT, NOTICE_NM
		FROM NOTICE 
		JOIN NOTICE_TYPE USING (NOTICE_CD)
		WHERE NOTICE_NO = 23
		AND NOTICE_ST = 'N';



-- 공지사항 이미지 테이블
DROP TABLE "NOTICE_IMG";

CREATE TABLE "NOTICE_IMG" (
	"IMG_NO"	NUMBER		NOT NULL,
	"IMG_LEVEL"	NUMBER		NOT NULL,
	"IMG_NM"	VARCHAR2(500)		NOT NULL,
	"IMG_ORIGINAL"	VARCHAR2(500)		NOT NULL,
	"NOTICE_NO"	NUMBER		NOT NULL
);

COMMENT ON COLUMN "NOTICE_IMG"."IMG_NO" IS '이미지 번호';
COMMENT ON COLUMN "NOTICE_IMG"."IMG_LEVEL" IS '이미지 위치';
COMMENT ON COLUMN "NOTICE_IMG"."IMG_NM" IS '이미지 이름';
COMMENT ON COLUMN "NOTICE_IMG"."IMG_ORIGINAL" IS '이미지 원본명';
COMMENT ON COLUMN "NOTICE_IMG"."NOTICE_NO" IS '공지사항 번호';


-- 이미지 번호 시퀀스 생성
CREATE SEQUENCE SEQ_IMG_NO NOCACHE;

-- 샘플데이터
INSERT INTO NOTICE_IMG VALUES(SEQ_IMG_NO.NEXTVAL, 0,'/resources/images/notice/sample1.png', 'pick1.png', 32);
INSERT INTO NOTICE_IMG VALUES(SEQ_IMG_NO.NEXTVAL, 1,'/resources/images/notice/sample2.png', 'pick2.png', 32);
INSERT INTO NOTICE_IMG VALUES(SEQ_IMG_NO.NEXTVAL, 1,'/resources/images/notice/sample1.png', 'pick1.png', 31);

SELECT * FROM NOTICE_IMG
WHERE NOTICE_NO = 69
ORDER BY IMG_LEVEL;

-- 다음 공지 게시글 번호
SELECT SEQ_NOTICE_NO.NEXTVAL FROM DUAL;

DELETE FROM NOTICE_IMG
WHERE NOTICE_NO = 70
AND IMG_LEVEL IN (0);


SELECT * FROM(
	SELECT ROWNUM RNUM, A.* FROM(
		SELECT NOTICE_NO, NOTICE_NM, NOTICE_TITLE, MEMBER_NO, 
			TO_CHAR(CREATE_DT, 'YYYY.MM.DD') AS CREATE_DT, READ_COUNT, NOTICE_ST
		FROM NOTICE
		JOIN NOTICE_TYPE USING (NOTICE_CD)
		WHERE NOTICE_TITLE LIKE '%test%' 
		ORDER BY NOTICE_NO DESC
	) A
)
WHERE RNUM BETWEEN 1 AND 100;



-- 회원 샘플 
INSERT INTO MEMBER
VALUES(0, 'admin@doran.com', 'doran1234', '관리자', 'F', SYSDATE, '01012345678', '관리자', 'N', '/resources/images/admin.png', '서울');
INSERT INTO MEMBER
VALUES(1, 'user@doran.com', 'doran1234', '유저일', 'M', SYSDATE, '01012345678', '유저일', 'N', '/resources/images/user.png', '서울');
INSERT INTO MEMBER
VALUES(2, 'user2@doran.com', 'doran1234', '유저이', 'M', SYSDATE, '01012345678', '유저이', 'N', '/resources/images/user.png', '서울');

-- 모임 샘플 
INSERT INTO COMMUNITY
VALUES(1, '도란도란 1번 모임', '/resources/images/sample.png', '이곳은 소개글 입니다', '서울 종로구', 
		DEFAULT, '이곳은 공지사항 입니다', 2, 41);

INSERT INTO COMMUNITY
VALUES(2, '도란도란2', '/resources/images/sample.png', '도란도란2 소개글 입니다', '서울 ', 
		DEFAULT, '이곳은 공지사항 입니다', 1, 41);



SELECT SIGNUP_NO, MEMBER_NICK, PROFILE_IMG, SIGNUP_CONTENT,  
	TO_CHAR(CREATE_DT, 'YYYY-MM-DD') CREATE_DT
FROM SIGNUP
JOIN MEMBER USING(MEMBER_NO)
WHERE COMMUNITY_NO = 1
AND SIGNUP_ST = 'N'
ORDER BY SIGNUP_NO;

CREATE SEQUENCE SEQ_SIGNUP_NO;


INSERT INTO SIGNUP
VALUES(SEQ_SIGNUP_NO.NEXTVAL, 1, '가입인사1 테스트', DEFAULT, SYSDATE, 1);
INSERT INTO SIGNUP
VALUES(SEQ_SIGNUP_NO.NEXTVAL, 1, '가입인사2 테스트', DEFAULT, SYSDATE, 1);
INSERT INTO SIGNUP
VALUES(SEQ_SIGNUP_NO.NEXTVAL, 1, '가입인사3 테스트', DEFAULT, SYSDATE, 1);
INSERT INTO SIGNUP
VALUES(SEQ_SIGNUP_NO.NEXTVAL, 1, '가입인사4 테스트', DEFAULT, SYSDATE, 0);

SELECT * FROM SIGNUP;



SELECT BOARD_NO, BOARD_TITLE, BOARD_CONTENT, 
		TO_CHAR(CREATE_DT, 'YYYY-MM-DD') CREATE_DT,
		READ_COUNT, MEMBER_NICK, PROFILE_IMG, MEMBER_NO, BOARD_NM
FROM BOARD 
JOIN MEMBER USING(MEMBER_NO)
JOIN BOARD_TYPE USING(BOARD_CD)
WHERE BOARD_NO = 1
AND BOARD_ST = 'N'
AND COMMUNITY_NO = 1; 


-- 자유게시글 검색
SELECT COUNT(*) FROM BOARD
JOIN MEMBER USING(MEMBER_NO)
WHERE BOARD_ST= 'N'
AND BOARD_CD = 1
AND COMMUNITY_NO = 1;


-- 모임 메인 자유게시글 조회
SELECT COMMUNITY_NO, COMMUNITY_NM, COMMUNITY_IMG, COMMUNITY_INFO, COMMUNITY_DETAIL, 
		COMMUNITY_AREA, MEMBER_NICK, PROFILE_IMG, COMMUNITY_NOTICE,

		SELECT BOARD_NO, BOARD_NM, BOARD_TITLE, TO_CHAR(CREATE_DT, 'YYYY-MM-DD') AS CREATE_DT, READ_COUNT 
			FROM(
				SELECT ROWNUM RNUM, A.* FROM(
					SELECT BOARD_NO, BOARD_NM, BOARD_TITLE, MEMBER_NICK,
						TO_CHAR(CREATE_DT, 'YYYY-MM-DD') AS CREATE_DT, READ_COUNT
					FROM BOARD
					JOIN BOARD_TYPE USING(BOARD_CD)
					JOIN MEMBER USING(MEMBER_NO)
					WHERE BOARD_CD = 1
					AND BOARD_ST = 'N'
					ORDER BY BOARD_NO DESC
				) A
			)
FROM COMMUNITY
JOIN MEMBER USING(MEMBER_NO)
JOIN BOARD USING(COMMUNITY_NO)
WHERE COMMUNITY_NO = 1
WHERE RNUM BETWEEN 1 AND 5
AND BOARD_CD = 1;



SELECT * FROM(
	SELECT ROWNUM RNUM, A.* FROM(
		SELECT BOARD_NO, BOARD_NM, BOARD_TITLE, MEMBER_NICK,
			TO_CHAR(CREATE_DT, 'YYYY-MM-DD') AS CREATE_DT, READ_COUNT
		FROM BOARD
		JOIN BOARD_TYPE USING(BOARD_CD)
		JOIN MEMBER USING(MEMBER_NO)
		WHERE BOARD_CD = 1
		AND BOARD_ST = 'N'
		ORDER BY BOARD_NO DESC
	) A
)
WHERE RNUM BETWEEN 1 AND 5;



SELECT BOARD_NO, BOARD_TITLE, BOARD_CONTENT, 
		TO_CHAR(CREATE_DT, 'YYYY-MM-DD') CREATE_DT,
		READ_COUNT, MEMBER_NICK, PROFILE_IMG, MEMBER_NO, BOARD_NM
FROM BOARD 
JOIN MEMBER USING(MEMBER_NO)
JOIN BOARD_TYPE USING(BOARD_CD)
WHERE BOARD_NO = 1
AND BOARD_ST = 'N'
AND COMMUNITY_NO = 1; 

SELECT * FROM BOARD_IMG
WHERE BOARD_NO = 22
ORDER BY IMG_LEVEL;


UPDATE BOARD_IMG SET IMG_LEVEL = 1, IMG_NM = 1, IMG_ORIGINAL = 1
		WHERE BOARD_NO = 1;


		SELECT * FROM(
			SELECT ROWNUM RNUM, A.* FROM(
				SELECT BOARD_NO, BOARD_NM, BOARD_TITLE, MEMBER_NICK,
		            TO_CHAR(CREATE_DT, 'YYYY-MM-DD') AS CREATE_DT, READ_COUNT
				FROM BOARD
				JOIN BOARD_TYPE USING(BOARD_CD)
				JOIN MEMBER USING(MEMBER_NO)
				WHERE BOARD_CD = 1
				AND COMMUNITY_NO = 1
				AND BOARD_ST = 'N'

				AND BOARD_TITLE LIKE '%test%'
				ORDER BY BOARD_NO DESC
			) A
		)
		WHERE RNUM BETWEEN 1 AND 100;


SELECT BOARD_NM FROM BOARD_TYPE 
JOIN
WHERE BOARD_CD = 1
AND COUMMUNITY_NO = 1;


-- 댓글 샘플
CREATE SEQUENCE SEQ_REPLY_NO;

INSERT INTO REPLY VALUES (SEQ_REPLY_NO.NEXTVAL,'댓글 내용','N',DEFAULT, 1, 0);
INSERT INTO REPLY VALUES (SEQ_REPLY_NO.NEXTVAL,'댓글 샘플','N',DEFAULT, 1, 0);

-- 댓글 조회
SELECT REPLY_NO, REPLY_CONTENT,
	TO_CHAR(CREATE_DT, 'YYYY-MM-DD') CREATE_DT,
	BOARD_NO, MEMBER_NO, MEMBER_NICK, PROFILE_IMG
FROM REPLY
JOIN MEMBER USING(MEMBER_NO)
WHERE REPLY_ST = 'N'
AND BOARD_NO = 1
ORDER BY REPLY_NO;

SELECT BOARD_NM FROM BOARD_TYPE WHERE BOARD_CD = 1;



SELECT * FROM(
	SELECT ROWNUM RNUM, A.* FROM(
		SELECT BOARD_NO, BOARD_NM, BOARD_TITLE, BOARD_CONTENT, MEMBER_NICK, PROFILE_IMG,
			TO_CHAR(CREATE_DT, 'YYYY-MM-DD') AS CREATE_DT, READ_COUNT
		FROM BOARD
		JOIN BOARD_TYPE USING(BOARD_CD)
		JOIN MEMBER USING(MEMBER_NO)
		WHERE BOARD_CD = 2
		AND COMMUNITY_NO = 1
		AND BOARD_ST = 'N'
		ORDER BY BOARD_NO DESC
	) A
)
WHERE RNUM BETWEEN 1 AND 10;

-- 모임 후기 게시판 조회
SELECT * FROM(
	SELECT ROWNUM RNUM, A.* FROM(
		SELECT BOARD_NO, BOARD_NM, BOARD_TITLE, BOARD_CONTENT, MEMBER_NICK, PROFILE_IMG,
			TO_CHAR(CREATE_DT, 'YYYY-MM-DD') AS CREATE_DT, READ_COUNT,
			(SELECT IMG_NM FROM BOARD_IMG
			WHERE IMG_LEVEL = 0
			AND BOARD_IMG.BOARD_NO = BOARD.BOARD_NO) IMG0,
			(SELECT IMG_NM FROM BOARD_IMG
			WHERE IMG_LEVEL = 1
			AND BOARD_IMG.BOARD_NO = BOARD.BOARD_NO) IMG1
		FROM BOARD
		JOIN MEMBER USING(MEMBER_NO)
		JOIN BOARD_TYPE USING(BOARD_CD)
		WHERE BOARD_CD = 2
		AND COMMUNITY_NO = 1
		AND BOARD_ST = 'N'
		ORDER BY BOARD_NO DESC
	) A
)
WHERE RNUM BETWEEN 1 AND 100;


SELECT * FROM(
	SELECT ROWNUM RNUM, A.* FROM(
		SELECT BOARD_NO, BOARD_TITLE, MEMBER_NICK, 
			TO_CHAR(CREATE_DT, 'YYYY-MM-DD') AS CREATE_DT, READ_COUNT
		FROM BOARD
		JOIN MEMBER USING(MEMBER_NO)
		JOIN BOARD_TYPE USING(BOARD_CD)
		WHERE BOARD_CD = 1
		AND COMMUNITY_NO = 1
		AND BOARD_ST = 'N'
		ORDER BY BOARD_NO DESC
	) A
)
WHERE RNUM BETWEEN 1 AND 5;


	SELECT ROWNUM RNUM, A.* FROM(
		SELECT MEMBER_NICK, PROFILE_IMG, SIGNUP_CONTENT,  
			TO_CHAR(CREATE_DT, 'YYYY-MM-DD') CREATE_DT
		FROM SIGNUP
		JOIN MEMBER USING(MEMBER_NO)
		WHERE COMMUNITY_NO = 1
		AND SIGNUP_ST = 'N'
		ORDER BY SIGNUP_NO 
			) A
WHERE RNUM BETWEEN 1 AND 5;


-- 메인 후기 사진만
SELECT * FROM(
	SELECT ROWNUM RNUM, A.* FROM(
		SELECT BOARD_TITLE, BOARD_CONTENT, PROFILE_IMG, MEMBER_NICK, IMG_NM
		FROM BOARD
		JOIN MEMBER USING(MEMBER_NO)
		JOIN BOARD_TYPE USING(BOARD_CD)
		JOIN BOARD_IMG USING(BOARD_NO)
		WHERE BOARD_CD = 2
		AND COMMUNITY_NO = 1
		AND BOARD_ST = 'N'
		AND IMG_NO IS NOT NULL
		AND IMG_LEVEL = 0
		ORDER BY BOARD_NO DESC
	) A
)
WHERE RNUM BETWEEN 1 AND 4;

SELECT COMMUNITY_NO, COMMUNITY_NM, COMMUNITY_INFO, COMMUNITY_NOTICE 
				COMMUNITY_AREA, MEMBER_NICK, PROFILE_IMG, COMMUNITY_FL
		FROM COMMUNITY
		JOIN MEMBER ON(MEMBER_NO = COMMUNITY_ADMIN)
		WHERE COMMUNITY_NO = 62
		AND COMMUNITY_FL = 'N';

SELECT NOTICE_NM FROM NOTICE_TYPE WHERE NOTICE_CD = 1;

SELECT * FROM(
			SELECT ROWNUM RNUM, A.* FROM(
				SELECT NOTICE_NO, NOTICE_NM, NOTICE_TITLE, MEMBER_NICK, 
					TO_CHAR(CREATE_DT, 'YYYY.MM.DD') CREATE_DT
				FROM NOTICE
				JOIN MEMBER USING(MEMBER_NO)
				JOIN NOTICE_TYPE USING (NOTICE_CD)
				WHERE NOTICE_ST = 'N'
				AND NOTICE_CD = 1
				ORDER BY NOTICE_NO DESC
			) A
		)
		WHERE RNUM BETWEEN 1 AND 5;

INSERT INTO REPLY VALUES (SEQ_REPLY_NO.NEXTVAL,'댓글 내용','N',DEFAULT, 1, 0);
INSERT INTO PICK VALUES (1, 1);
INSERT INTO PICK VALUES (1, 2);
INSERT INTO PICK VALUES (2, 2);

INSERT INTO COMMUNITY_MEMBER VALUES (1, 1,'N');

SELECT COMMUNITY_NO, COMMUNITY_NM, COMMUNITY_INFO, COMMUNITY_NOTICE, 
				COMMUNITY_AREA, MEMBER_NICK, PROFILE_IMG, COMMUNITY_ADMIN
		FROM COMMUNITY
		JOIN MEMBER ON(MEMBER_NO = COMMUNITY_ADMIN)
		WHERE COMMUNITY_NO = 1
		AND COMMUNITY_FL = 'N';